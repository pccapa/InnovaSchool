@model System.Collections.Generic.IEnumerable<GAA.Entity.CitaAdmision>
@{
    Layout = "~/Views/_Layout.cshtml";
    ViewBag.Title = "Consulta Gestión Admisión";
}

<h2>Lista de Solcitudes</h2>

@using (Html.BeginForm(null, null, FormMethod.Post, new { id = "onlineform" }))
{
    @Html.AntiForgeryToken()

    <script type="text/javascript">

        $(document).ready(function () {

            $('#btnNuevaSolicitud').click(function () {
                window.location.href = '/GestionAdmision/Create/';
            });

            $('#btnSalir').click(function () {
                window.location.href = '/Principal/Index/';
            });

        });

        function EliminarRegistro(codigo){
            if (confirm('Está seguro de eliminar la postulación?. La Cita será eliminada.')){
                $.ajax({
                    cache: false,
                    type: "GET",
                    url: "/GestionAdmision/Eliminar",
                    data: { "codCitaAdmision": $(this).val() },
                    success: function (response) {
                        if (response != null && response.success && response.responseText == 'OK') {
                            alert("Se eliminó la postulación satisfactoriamente");
                            window.location.href = '/GestionAdmision/Consulta/';
                        }else {
                            alert(response.responseText);
                        }
                    }
                });
            }
        }


    </script>

    <fieldset>
        <legend>Datos de postulaciones</legend>
        <br />
        <div class="btn-group">
            <input type="button" value="Registrar nueva Solicitud de Admisión" id="btnNuevaSolicitud" class="btn-primary" />
            <input type="button" value="Salir" id="btnSalir" class="btn-primary" />
        </div>
        <p>
        </p>
        <table class="table-bordered table-hover" style="width:80%" align="left">
            <thead>
                <tr>Editar</tr>
                <tr>Eliminar</tr>
                <tr>Código</tr>
                <tr>Grado postulación</tr>
                <tr>Postulante</tr>
                <tr>Sucursal</tr>
                <tr>Fecha</tr>
                <tr>Hora</tr>
                <tr>Estado</tr>
                <tr>Acción</tr>
            </thead>
            <tbody>
                @foreach (var item in @Model)
                {
                    <tr>
                        <td><img src="~/Images/modify.png" class="img-rounded" alt="Modificar" onclick="window.location.href = '/GestionAdmision/Modify/@item.IdCitaAdmision';"></td>
                        <td><img src="~/Images/delete.png" class="img-rounded" alt="Eliminar" onclick="EliminarRegistro(@item.IdCitaAdmision);"></td>
                        <td>@item.IdCitaAdmision </td>
                        <td>@item.SolicitudAdmision.Grado.Descripcion </td>
                        <td>@item.SolicitudAdmision.Postulante.FullName </td>
                        <td>@item.SolicitudAdmision.Sucursal.Descripcion </td>
                        <td>@item.SolicitudAdmision.Fecha </td>
                        <td>@item.SolicitudAdmision.Hora </td>
                        <td>@item.EstadoCita.Descripcion </td>
                        <td>@item.EstadoCita.Descripcion </td>
                    </tr>
                }
            </tbody>
        </table>

    </fieldset>
}